<!DOCTYPE html>
<html>
<head>
    <title>管理后台首页 {$site_info.site_name|default=''}</title>
    <meta name="keywords" content="{$site_info.site_seo_keywords|default=''}" />
    <meta name="description" content="{$site_info.site_seo_description|default=''}">
    {block name="header"}{include file="Public:header" /}{/block}
    {load href="/static/admin/detault/css/common.css" /}
    {load href="/static/admin/detault/css/index.css" /}
</head>

<body style="overflow: hidden;">
            <nav class="navbar navbar-dark bg-dark">
        <a class="navbar-brand p-2 ml-2" href="/admin">
            <img src="https://v4.bootcss.com/docs/4.3/assets/brand/bootstrap-solid.svg" width="30" height="30" class="d-inline-block align-top" alt="">
            <strong class="text-white ml-4">
                FastEdu后台管理系统
            </strong>
        </a>
    </nav>
    <div class="container-fluid h-100">
        <div class="row justify-content-center h-100">
            <div class="col-lg-2 col-md-2 bg-white p-0 h-100 border-right">
                {block name="leftMenu"}{include file="Public:leftMenu" /}{/block}
            </div>
            <div class="col-lg-10 col-md-10 p-0">
                <div class="embed-responsive embed-responsive-16by9">
                    <iframe class="embed-responsive-item" name="programContent" src="" allowfullscreen></iframe>
                </div>
            </div>
        </div>
    </div>
</body>

{block name="script"}{include file="Public:script" /}{/block}
<script type="text/javascript">
$(".nav-link").click(function() {
    $(this).parent().find('.list-group').toggle(500)
});
$(".nav-link").hover(function() {
    $(this).find('.fa').toggleClass("fa-color")
});




//逻辑待整理------

var src = $(window.parent.document).find(".embed-responsive-item").attr("src");
console.log(src);
var uri = window.location.href;

var url = window.localStorage.getItem('sessionUri');
if (uri.indexOf("#") != -1) {
    src = url;
}


if (!src) {
    var detault = window.location.href + '/main';
    $(window.parent.document).find(".embed-responsive-item").attr("src", detault);
}

//iframe 处理
$(".sessionUri").click(function() {
    var href = $(this).attr("href");

    //获取原始路径
    uri = window.location.origin + '/admin/'
    //截取标识
    hrefs = href.replace(window.location.origin, '');
    //生成新的url
    var newUrl = uri + "#" + hrefs;
    history.pushState({}, "", newUrl);
    window.localStorage.setItem("sessionUri", href)

});

//刷新当前页面
var url = window.localStorage.getItem('sessionUri');
var uri = window.location.href;

if (url && uri.indexOf("#") != -1) {
    $(window.parent.document).find(".embed-responsive-item").attr("src", url);
}


onbeforeunload = reload()

function reload() {

    if (url && uri.indexOf("#") != -1) {
        $(window.parent.document).find(".embed-responsive-item").attr("src", url);
    }
}
</script>

</html>